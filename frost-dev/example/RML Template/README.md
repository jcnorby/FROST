# RML Template

### Usage
This template contains example scripts to create, solve, and visualize a trajectory optimization that maximizes Spirit 40 jumping height. If FROST is installed correctly this script should run out of the box (if it doesn't please contact jnorby@andrew.cmu.edu), but it can also be used as a starting point for creating other robot optimizations. For a simpler example (e.g. one without a urdf), see examples/nlp_example. 

To create a new optimization:
- Copy the RML Template folder and rename to your project (Do not alter this one!)
- Put your urdf in the urdf/ dir
- Update sys.LoadModel with any platform specific constraints
- Update sys.domains with the continuous/hybrid domains you'll need
- Update sys.frames with convenient coordinate frames
- Update sys.LoadSystem with the hybrid system you want
- Update sys.LoadProblem with the NLP you want
    - Individual cost and constraint functions are defined in opt/costs and opt/constraints
    - Constraints are assigned to specific domains in opt/callbacks
- Update opt_var bounds in opt/GetBounds
- Run this script, make sure that the following are called to compile necessary files:
    - plot.LoadRobotDisplay(robot);
    - compileObjective(nlp,[],[],export_path);
    - compileConstraints(nlp,[],[],export_path);

### Useful Scripts and Folders
- `main.m` - Primary script that calls everything else.
- `opt/` - Directory containing all the optimization related scripts. `LoadProblem.m` loads the optimization problem, `opt/costs/` and `opt/constraints/` define the cost and constraint functions, `opt/callbacks/` assigns constraints to certain domains.
- `plot/` - Directory containing plotting scripts relevant to this example. See `frost-dev/matlab/frost/Animator` for more of the general plotting and animation scripts.
- `sys/` - Directory containing scripts to load the robot model and define the hybrid system (if applicable). Also defines domains of continuous and discrete domains and any relevant coordinate frames (such as the robot feet) in `sys/domains` and `sys/frames`.
- `gaits/` - Directory containing saved gaits (as .mat files)
- `gen` - Directory containing all generated C++ code and mex files. Should be ignored by git as there will be many files here after compilation.
- `local` - Directory containing any misc files generated by `main.m`, such as feasibility and optimality checking files.
- `scripts` - Directory containing any useful processing scripts. Feel free to add any largely applicable scripts here. The most useful of these is `saveResults.m` which will save to file the numerical results and the animation of the trajectory. This will also save to the cloud if a local path to a cloud folder is provided.
- `urdf` - Directory containing relevant urdf files.
- `videos` - Directory containing videos of gaits (these are ignored by git but can be handy to keep locally)